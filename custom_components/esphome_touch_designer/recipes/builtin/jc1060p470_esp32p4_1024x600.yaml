# Built-in hardware recipe
# Source: https://github.com/postsi/ESPHomeDesigner/blob/main/custom_components/esphome_designer/frontend/hardware/jc1060p470-esp32p4.yaml

# ============================================================================
# ESPHome YAML - Generated by ESPHome Designer
# ============================================================================
# TARGET DEVICE: JC1060P470 7" 1024x600 (ESP32-P4)
#         - Display Platform: MIPI DSI
#         - PSRAM: Yes (Hex, 200MHz)
#         - Touchscreen: GT911 (I2C)
#         - Framework: ESP-IDF (Experimental Features)
#         - WiFi: ESP32-C6 Co-processor (esp32_hosted)
# ============================================================================
#
# HARDWARE NOTES:
# This device uses the ESP32-P4 chip with an ESP32-C6 as a WiFi co-processor.
# The display is a 7" 1024x600 IPS panel connected via MIPI DSI interface.
# Requires ESPHome 2025.x or later with ESP32-P4 support.
#
# ============================================================================
#
# SETUP INSTRUCTIONS:
#
# STEP 1: Copy the Material Design Icons font file
#         - From this repo: resources/fonts/materialdesignicons-webfont.ttf
#         - To ESPHome: /config/esphome/fonts/materialdesignicons-webfont.ttf
#         (Create the fonts folder if it doesn't exist)
#
# STEP 2: Create a new device in ESPHome
#         - Click "New Device"
#         - Name: your-device-name
#         - Select: ESP32-P4
#         - Framework: ESP-IDF (Required for this device)
#
# STEP 3: PASTE this snippet into your device YAML
#         - Paste this snippet at the end of your configuration.
#         - System sections (esphome, esp32, psram, etc.) are auto-commented
#           to avoid conflicts with your existing setup.
#
# ============================================================================

esphome:
  min_version: 2025.1.0
  project:
    name: "JC1060P470.ESP32-P4-Touch-LCD-7"
    version: "1.0"
  on_boot:
    priority: 600
    then:
      - delay: 2s
      - script.execute: manage_run_and_sleep

esp32:
  variant: esp32p4
  flash_size: 16MB
  cpu_frequency: 360MHZ
  framework:
    type: esp-idf
    advanced:
      enable_idf_experimental_features: true

# ESP32-C6 WiFi Co-processor
esp32_hosted:
  variant: esp32c6
  reset_pin: GPIO54
  cmd_pin: GPIO19
  clk_pin: GPIO18
  d0_pin: GPIO14
  d1_pin: GPIO15
  d2_pin: GPIO16
  d3_pin: GPIO17
  active_high: true

psram:
  mode: hex
  speed: 200MHz

# ESP LDO for DSI PHY and SD Card
esp_ldo:
  - channel: 3
    id: dsi_phy_enable
    voltage: 2.5V
    adjustable: true
  - channel: 4
    id: sd_card_power
    voltage: 2.7V
    adjustable: true

preferences:
  flash_write_interval: 5min

# I2C for Touchscreen
i2c:
  - id: bus_a
    sda: GPIO07
    scl: GPIO08
    frequency: 400kHz

# Touchscreen - GT911
touchscreen:
  - platform: gt911
    id: my_touchscreen
    i2c_id: bus_a
    reset_pin: GPIO22
    interrupt_pin: GPIO21
    transform:
      swap_xy: false
      mirror_x: false
      mirror_y: false

# Display - JC1060P470 (MIPI DSI)
display:
  - platform: mipi_dsi
    id: my_display
    model: JC1060P470
    reset_pin:
      number: GPIO05
    rotation: 0
    update_interval: never
    auto_clear_enabled: false
    hsync_pulse_width: 20
    # __LAMBDA_PLACEHOLDER__

# Backlight control
output:
  - platform: ledc
    pin: GPIO23
    id: backlight_output

light:
  - platform: monochromatic
    id: display_backlight
    name: "Display Backlight"
    output: backlight_output
    default_transition_length: 0.5s
    restore_mode: ALWAYS_ON
    gamma_correct: 1.0

lvgl:
  #__LVGL_PAGES__
